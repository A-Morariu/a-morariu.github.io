<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Alin Morariu</title>
<link>https://a-morariu.github.io/posts.html</link>
<atom:link href="https://a-morariu.github.io/posts.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Wed, 10 Jul 2024 23:00:00 GMT</lastBuildDate>
<item>
  <title></title>
  <dc:creator>Alin Morariu</dc:creator>
  <link>https://a-morariu.github.io/posts/2024-07-11/</link>
  <description><![CDATA[ undefined ]]></description>
  <category>software</category>
  <category>dev</category>
  <category>git</category>
  <guid>https://a-morariu.github.io/posts/2024-07-11/</guid>
  <pubDate>Wed, 10 Jul 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Simulating an epidemic</title>
  <dc:creator>Alin Morariu</dc:creator>
  <link>https://a-morariu.github.io/posts/2024-07-01-simulating-epidemics/</link>
  <description><![CDATA[ 





<p>When I started my PhD two years ago, I had never looked at an epidemic model outside of an elementry differential equations course. Fast forward two years, and one Covid-19 later, the bulk of my work is centred around epidemic models. More specifically, <em>stochastic</em> epidemic models. Differential equation models are simple and easy to use but are often too rigid since they don’t reflect the randomness we see in the real world when it comes to the spread of disease.</p>
<p>This post is going to be a tutorial that I wish I had at the start of my epidemic modelling journey. The aim is to implement/code a chain binomial epidemic model in Python. This model is sometimes referred to as the Reed-Frost model and was initially used to model epidemic spread in the late 1920s (more details<sup>1</sup>). It is one of the simplest epidemic models as it only focuses on the infection process so take this as the base case. Future posts will dive deeper into the mathematics and how to expand on this model to make it more realistic.</p>
<section id="reed-frost-model" class="level2">
<h2 class="anchored" data-anchor-id="reed-frost-model">Reed-Frost model</h2>
<p>The Reed-Frost model helps us predict the number of people who will become infected over time, given some initial conditions.</p>
<section id="intuition" class="level3">
<h3 class="anchored" data-anchor-id="intuition">Intuition</h3>
<p>Imagine a group of people where some are initially infected with a disease, and others are susceptible but not yet infected. The Reed-Frost model works by dividing time into discrete steps<sup>2</sup>, such as days or weeks. At each time step, each susceptible person has a chance of getting infected based on their contact with infectious individuals.</p>
<p>At the beginning of the outbreak, the population is divided into two groups: susceptible (those who can get infected) and infectious (those who are currently infected). If we were to think of this as a graphical representation, it would be a 2 compartment model.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  A(Susceptible) --&gt; B(Infected)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>Now the question becomes how do individuals move between these states. The model uses a probability parameter to represent the likelihood that a susceptible person will get infected upon contact with an infectious person. This probability is often denoted as <img src="https://latex.codecogs.com/png.latex?p">.</p>
<p>The process unfolds over a series of discrete time steps. At each step, every susceptible individual has a chance to become infected if they come into contact with any infectious individuals (this is a very loose way to apply some mathematical structure to a very complex infection transmission mechanism).</p>
<p>The number of new infections at each time step depends on the number of susceptible and infectious individuals and the probability of transmission. The model assumes that once a person is infected, they remain infectious for only one time step.</p>
</section>
<section id="why-this-is-a-good-starting" class="level3">
<h3 class="anchored" data-anchor-id="why-this-is-a-good-starting">Why this is a good starting</h3>
<p>The Reed-Frost model is powerful because it captures the essential dynamics of disease transmission in a straightforward manner. It considers the key factors that drive an epidemic: the number of susceptible individuals, the number of infectious individuals, and the probability of transmission. By iterating this process over multiple time steps, the model can simulate the spread of an infection and help predict its potential impact on the population.</p>
</section>
</section>
<section id="python-implementation" class="level2">
<h2 class="anchored" data-anchor-id="python-implementation">Python implementation</h2>
<p>For this tutorial, I am going to try to use as few packages as possible so I’m going to restrict myself to <em>only</em> <code>numpy</code> and <code>pandas</code>. The rest of the code will be base Python.</p>
<div id="57f3850a" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load packages </span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd </span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns </span>
<span id="cb1-7"></span>
<span id="cb1-8">sns.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span></code></pre></div>
</div>
<p>Let’s take stock of what we know at this point. The Reed-Frost model which is a 2-state compartmental model.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a class of models and <em>not</em> a specific model.</p>
</div>
</div>
<p>To specify a model we need to add more structure. We want to know the size of population the disease is spreading through, the duration of each step in which events are happening (recall this is a discrete time model), and the last is going to be the transition rate or epidemic dynamics (how the disease is transmitted). The assumptions are as follows:</p>
<ol type="1">
<li>100 epidemic units<sup>3</sup> with 99 susceptibles and 1 infected units. This is represented as a vector <img src="https://latex.codecogs.com/png.latex?%5BS_0,%20I_0%5D%20=%20%5B99,1%5D"> (the subscript <img src="https://latex.codecogs.com/png.latex?i"> is the time period).</li>
<li>Time period is going to be daily so we set the time delta <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20d%20=%201">.</li>
<li>Epidemic dynamics will be a density based transmission where we ‘count’ the number of pairwise interactions between infectious units and susceptibles and divide by the population size. This means that the probabilty of an infection happening has a rate of <img src="https://latex.codecogs.com/png.latex?%5Clambda_i=%20%5Cbeta%20%5Cfrac%7BS_i%20I_i%7D%7BS_i%20+%20I_i%7D"> which translates into a probability of <img src="https://latex.codecogs.com/png.latex?p_i%20=%20%5Cexp%5C%7B-%20%5Clambda_i%20*%20%5Ctriangle%20d%20%5C%7D"><sup>4</sup>.</li>
</ol>
<div id="3744fa8c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initial values</span></span>
<span id="cb2-2">time_delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span>                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1 day </span></span>
<span id="cb2-3">initial_pop <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">99.</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span>]          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># population vector </span></span>
<span id="cb2-4">parameters0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># daily transmission parameter </span></span></code></pre></div>
</div>
<p>With the constants and initial conditions set, its time to move to the main bit of the code which performs the simulation.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>I’ve been using the term implementing a model and this doesn’t really have a set definition. In this case, implementation is done when you can simulate a correct trajectory of the epidemic but in other settings it may mean fitting a model to data, validating, predicting, etc. The scope of an implementation changes with the nature of the problem and is context specific. Its all jargon here.</p>
</div>
</div>
<p>The function below called <code>SI_iteration</code> takes 3 parameter values: 1. <code>parameters</code> - this is a vector of model parameters. For now, this is a 1D vector holding the value for <img src="https://latex.codecogs.com/png.latex?%5Cbeta">. 2. <code>state</code> - this is a 2D vector containing the counts for each of the states. 3. <code>time_delta</code> - the size (in days) of the discrete time step</p>
<div id="80150d9d" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="annotated-cell-3" style="background: #f1f3f5;"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> SI_iteration(parameters, state, time_delta):</span>
<span id="annotated-cell-3-2">  beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters</span>
<span id="annotated-cell-3-3">  num_susceptibles, num_infected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state</span>
<span id="annotated-cell-3-4">  </span>
<span id="annotated-cell-3-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: compute transition rates </span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-6" class="code-annotation-target">  SI_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> beta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(num_susceptibles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> num_infected)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(num_susceptibles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> num_infected)</span>
<span id="annotated-cell-3-7"></span>
<span id="annotated-cell-3-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: convert event rates to probabilities </span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-9" class="code-annotation-target">  i_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> SI_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> time_delta)</span>
<span id="annotated-cell-3-10"></span>
<span id="annotated-cell-3-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: simulate number of new infections </span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="3">3</button><span id="annotated-cell-3-12" class="code-annotation-target">  num_new_infections <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.binomial(num_susceptibles, i_rate)</span>
<span id="annotated-cell-3-13"></span>
<span id="annotated-cell-3-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4; state update</span></span>
<span id="annotated-cell-3-15">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> [num_susceptibles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> num_new_infections, num_infected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> num_new_infections]</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="6" data-code-annotation="1">Compute the transition rate</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="9" data-code-annotation="2">Turn the transition rate into a probability of new infections</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="12" data-code-annotation="3">Sample the number of new infections</span>
</dd>
</dl>
</div>
</div>
<p>I’m going to ignore the mathematics of Step 2 in chunk above <em>for now</em> since that will be its own post down the line. The gory details can be found in the paper I mentioned earlier for those curious. Now for using our new function! Taking the initial values for each of the arguments and plugging them in, we can get the outcome of a single iteration or single step of our epidemic process. This is not a complete path!</p>
<div id="7283e46d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="annotated-cell-4" style="background: #f1f3f5;"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># single iteration/forward step</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20240701</span>)</span>
<span id="annotated-cell-4-3">new_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SI_iteration(parameters0, initial_pop, time_delta)</span>
<span id="annotated-cell-4-4"></span>
<span id="annotated-cell-4-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'New state: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>new_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Set the seed for reproducible value.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>New state: [98.0, 2.0]</code></pre>
</div>
</div>
<section id="simulate-a-path" class="level3">
<h3 class="anchored" data-anchor-id="simulate-a-path">Simulate a path</h3>
<p>We can extend the single iteration to sample a full path of the epidemic by calling our function over and over again. This is not the most efficient way of performing a simulation but it is easy to understand so it’ll do for now.</p>
<div id="624b87ea" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simulate full path</span></span>
<span id="cb4-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> simulate(initial_state, num_steps):</span>
<span id="cb4-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># counters</span></span>
<span id="cb4-4">    ii <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-5">    S <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros(num_steps)</span>
<span id="cb4-6">    I <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros(num_steps)</span>
<span id="cb4-7"></span>
<span id="cb4-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># unpack the state</span></span>
<span id="cb4-9">    S[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], I[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_state</span>
<span id="cb4-10">    state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_state</span>
<span id="cb4-11"></span>
<span id="cb4-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> ii <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> num_steps:</span>
<span id="cb4-13">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># single iteration to update the state</span></span>
<span id="cb4-14">      state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SI_iteration(parameters0, state, time_delta)</span>
<span id="cb4-15">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># record the outcome</span></span>
<span id="cb4-16">      S[ii], I[ii] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state</span>
<span id="cb4-17"></span>
<span id="cb4-18">      ii <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-19"></span>
<span id="cb4-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time'</span>: np.cumsum(np.repeat(time_delta, num_steps)),</span>
<span id="cb4-21">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Susceptible'</span>: S,</span>
<span id="cb4-22">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Infected'</span>: I}</span></code></pre></div>
</div>
<p>And run a simulation of 100 steps (note that some of the steps might be non-events since every unit has progressed through the epidemic). There are nice ways of stopping simulations early by using a clever stop condition within the while loop.</p>
<div id="cell-epi_dataset" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">sample_epi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> simulate(initial_pop, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3">pd.DataFrame(sample_epi).head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div id="epi_dataset" class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Time</th>
<th data-quarto-table-cell-role="th">Susceptible</th>
<th data-quarto-table-cell-role="th">Infected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>99.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.0</td>
<td>97.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3.0</td>
<td>94.0</td>
<td>6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.0</td>
<td>86.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.0</td>
<td>74.0</td>
<td>26.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6.0</td>
<td>56.0</td>
<td>44.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7.0</td>
<td>41.0</td>
<td>59.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8.0</td>
<td>35.0</td>
<td>65.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9.0</td>
<td>29.0</td>
<td>71.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10.0</td>
<td>21.0</td>
<td>79.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Lets plot the simulation!</p>
<div id="cell-simulated_path" class="cell" width="80%" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb6-2"></span>
<span id="cb6-3">S_line <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.plot(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Susceptible"</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sample_epi, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-4">I_line <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.plot(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Infected"</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sample_epi, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-5"></span>
<span id="cb6-6">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Days"</span>,fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb6-7">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>,fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb6-8"></span>
<span id="cb6-9">legend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.legend(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>,loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb6-10">frame <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> legend.get_frame()</span>
<span id="cb6-11">frame.set_facecolor(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb6-12">frame.set_linewidth(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb6-13"></span>
<span id="cb6-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add labels and title</span></span>
<span id="cb6-15">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Days'</span>, fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add x-axis label with font styling</span></span>
<span id="cb6-16">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Count'</span>, fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add y-axis label with font styling</span></span>
<span id="cb6-17">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Single path simulation'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add plot title with font size</span></span>
<span id="cb6-18"></span>
<span id="cb6-19">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/simulated_path-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Full path of an epidemic. Simulation is done by calling the single iteration function repeatedly"><img src="https://a-morariu.github.io/posts/2024-07-01-simulating-epidemics/index_files/figure-html/simulated_path-output-1.png" width="1140" height="607" alt="Full path of an epidemic. Simulation is done by calling the single iteration function repeatedly" class="figure-img"></a></p>
<figcaption>Full path of an epidemic. Simulation is done by calling the single iteration function repeatedly</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>In this tutorial, I showed one way to implement a chain binomial epidemic model. This basic model is a great starting point for building more complex and realistic models. The function <code>SI_iteration</code> uses a simplified version of the <a href="https://en.wikipedia.org/wiki/Gillespie_algorithm">Gillespie algorithm</a> which is the standard algorithm for simulating stochastic trajectories for these types of systems. I’d also recommend checking out <a href="https://lewiscoleblog.com/gillespie-algorithm">this blog</a> post by Lewis Cole for an in depth look at the algorithm.</p>
</section>
<section id="next-steps" class="level3">
<h3 class="anchored" data-anchor-id="next-steps">Next steps</h3>
<p>As far as using epidemic models in the real world goes, simulation is only one half of the coin. The other side has to do with fitting these models. If the problem was reversed and we had observed an epidemic process, recorded the data and created a data set that looks something like <span class="citation" data-cites="epi_dataset">@epi_dataset</span> we could then try to find the value of <code>parameters</code> which generated that data. This can be done in a variety of ways such as maximum likelihood estimation or Bayesian inference. If this type of problem interests you, I’d highly recommend checking out the <a href="https://gem-epidemics.gitlab.io/iddinf/">IDDinf 2024</a> inference course. This is a course I will be co-teaching with some incredible people in September 2024 and will go over everything you need to know to fit epidemic models with Bayesian inference.</p>
</section>
<section id="thanks-for-reading" class="level3">
<h3 class="anchored" data-anchor-id="thanks-for-reading">Thanks for reading</h3>
<p>In my spare time, I like to take photos so I’m going to add one photo I like at the end of each post as a thank you :) <a href="DSC_6355.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Ile du Frioul, Marseille, France, 2024"><img src="https://a-morariu.github.io/posts/2024-07-01-simulating-epidemics/DSC_6355.jpg" class="img-fluid" alt="Ile du Frioul, Marseille, France, 2024"></a></p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://deepblue.lib.umich.edu/bitstream/handle/2027.42/26512/0000050.pdf?sequence=1&amp;isAllowed=y&amp;fbclid=IwAR38zIDg_-vvXCMWHDoy-6rLXAluIa5ggiCmsalzh1IUBFaVxACS6KF3Cms">Resource here</a>↩︎</p></li>
<li id="fn2"><p>I usually work with continuous time models which pose their own challenges. More on this will come in later posts↩︎</p></li>
<li id="fn3"><p>An epidemic unit can be anything that we can classify as susceptible or infected. These models are used for humans and animals so its easier to generalize the concept of an epidemic unit. The units can even be aggregated to represent households or farms. It gives us a more flexibility to adapt the scope of the model.↩︎</p></li>
<li id="fn4"><p>Future post on the interpretable mathematics of epidemic models↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>epidemics</category>
  <category>simulation</category>
  <guid>https://a-morariu.github.io/posts/2024-07-01-simulating-epidemics/</guid>
  <pubDate>Sun, 30 Jun 2024 23:00:00 GMT</pubDate>
  <media:content url="https://a-morariu.github.io/posts/2024-07-01-simulating-epidemics/DSC_6355.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title></title>
  <dc:creator>Alin Morariu</dc:creator>
  <link>https://a-morariu.github.io/posts/2024-01-01-first-post/</link>
  <description><![CDATA[ undefined ]]></description>
  <category>other</category>
  <guid>https://a-morariu.github.io/posts/2024-01-01-first-post/</guid>
  <pubDate>Mon, 01 Jan 2024 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
